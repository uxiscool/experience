/* =========================
   Base / Variables
   ========================= */
:root{
  --gap: .6rem;
  --muted: #888;
  --brand: #ff9900;
  --bg: #171819;
  --card: #232429;
  --text: #fffdfb;
}

*{ box-sizing:border-box; }
html,body{ margin:0; padding:0; }
body{
  background:var(--bg);
  color:var(--text);
  font-family:"SF Pro Display","San Francisco",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
  line-height:1.45;
}
body.lb-lock{ overflow:hidden; }

img{ max-width:100%; height:auto; display:block; }
a{ color:inherit; text-decoration:none; }

/* =========================
   Layout
   ========================= */
section{ padding-top:2rem; }

.container{
  margin:0;
  padding-left:280px;
  padding-right:280px;
  max-width:none;
  width:100%;
}
@media (max-width:980px){
  .container{ padding-left:64px; padding-right:64px; }
}

/* =========================
   Header / Nav (минимально)
   ========================= */
header{ display:flex; align-items:flex-start; gap:36px; margin-top:36px; }
.nav-wrapper{ display:flex; flex-direction:column; align-items:flex-start; width:100%; }

/* =========================
   Global helpers
   ========================= */
.hidden{ display:none !important; }

/* =========================
   Pet Projects
   ========================= */

/* Короткое описание раздела */
.pet-meta{ padding:48px 280px; margin:0 0 28px; }
@media (max-width:980px){ .pet-meta{ padding:0 64px; } }
.pet-meta .case-summary2{ margin:0; }

/* Сетка карточек: фикс-треки по 660px, прижаты влево */
.pp-grid{
  padding:0 280px 32px;
  display:grid;
  gap:22px;
  grid-template-columns:repeat(auto-fill, minmax(min(100%, 660px), 660px));
  justify-content:start;
}
@media (max-width:980px){ .pp-grid{ padding:0 64px 24px; } }
@media (min-width:1152px){ .pp-grid{ padding-right:100px; } }

/* Карточка */
.pp-card{
  display:grid;
  grid-template-rows:auto 1fr;
  gap:12px;
  background:var(--card);
  border-radius:18px;
  box-shadow:0 2px 14px #181a1c29;
  padding:16px;
  min-height:220px;
  min-width:0;
  container-type:inline-size;
  width:100%;
}

/* Шапка карточки */
.pp-header{
  display:grid;
  grid-template-columns:32px 1fr;
  gap:10px;
  align-items:center;
  margin:0;
  min-width:0;
}
.pp-icon{ width:32px; height:32px; display:block; }
.pp-title{
  margin:0;
  font-size:1.15rem;
  color:#fff;
  letter-spacing:.01em;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Тело карточки: две колонки, растягиваются по высоте */
.pp-body{
  display:grid;
  grid-template-columns:minmax(0,1fr) minmax(0,1.2fr);
  gap:16px;
  align-items:stretch;
  min-width:0;
}
/* Узкая карточка ≤480px — в одну колонку */
@container (max-width:480px){
  .pp-body{ grid-template-columns:1fr; }
}

/* Медиа-блок слева */
.pp-media{
  position:relative;
  overflow:hidden;
  border-radius:12px;
  background:var(--card);
  aspect-ratio:4 / 3;   /* удерживаем высоту, нет скачков */
  min-width:0;
}
.pp-media-link{
  position:relative;
  display:block;
  width:100%;
  height:100%;
}
/* Скелетон поверх медиаблока (уходит, когда .has-loaded на родителе) */
.img-skel{
  position:absolute; inset:0;
  border-radius:12px;
  background:linear-gradient(90deg,#2b2e33 25%, #3a3f45 37%, #2b2e33 63%);
  background-size:400% 100%;
  animation:skel-shimmer 1.2s ease-in-out infinite;
  pointer-events:none;
}
@keyframes skel-shimmer{ 0%{background-position:100% 0} 100%{background-position:0 0} }
.has-loaded .img-skel{ display:none; }

/* Картинка в медиаблоке: вписывается, не кропится */
.pp-media .lazy-img{
  width:100%; height:100%;
  max-width:100%; max-height:100%;
  object-fit:contain;
  display:block;
  opacity:0;                   /* проявление после декодинга */
  transition:opacity .25s ease;
}
.lazy-img.is-loaded{ opacity:1; }

/* Правая колонка: текст сверху, футер прижат вниз */
.pp-side{
  display:grid;
  grid-template-rows:1fr auto;
  min-width:0;
  align-self:stretch;
}
.pp-text{
  display:flex; flex-direction:column;
  gap:8px; align-items:flex-start;
  min-width:0;
}
.pp-subtitle{
  color:#cdd3db;
  opacity:.92;
  font-size:.98rem;  /* фикс опечатки */
}
.pp-desc{
  color:#cdd3db;
  opacity:.92;
  font-size:.98rem;
  line-height:1.35;
}

/* Футер справа снизу */
.pp-footer{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:6px;
  align-self:end;
  margin-top:0;
}
.pp-kind{ color:#cbd2db; font-size:.9rem; opacity:.95; text-align:right; }
.pp-links{ display:flex; gap:10px; align-items:center; justify-content:flex-end; }
.pp-links img{ height:32px; width:auto; display:block; }
.pp-links a.pp-store{ display:inline-flex; align-items:center; justify-content:center; border-radius:8px; }
.pp-links a.pp-store:focus-visible{ outline:2px solid var(--brand); outline-offset:3px; }

/* =========================
   Cases (галерея)
   ========================= */
.case-gallery{ display:grid; gap:16px; }

.case-gallery-item{
  background:#1e2025;
  border-radius:12px;
  padding:12px;
}

.case-img-wrap{
  background:transparent;              /* одна подложка — на item */
  width:100%;
  aspect-ratio:4 / 3;
  display:flex; align-items:center; justify-content:center;
  position:relative; overflow:hidden;
  border-radius:12px;
}

/* Превью кейсов — вписывается, не кропится */
.case-thumb2{
  width:100%; height:100%;
  max-width:100%; max-height:100%;
  object-fit:contain;
  background:transparent;
  border-radius:0; margin-bottom:0;
  cursor:pointer; transition:filter .14s;
}

/* Подпись под превью */
.case-thumb-caption{
  margin-top:8px;
  font-size:.95rem;
  color:#e2e5e7;
  opacity:.9;
}

/* =========================
   Lightbox
   ========================= */
.lightbox{
  position:fixed; inset:0; z-index:9999;
  display:flex; align-items:center; justify-content:center;
  background:#16181ef0;
  animation:lightbox-fade-in .5s;
}
@keyframes lightbox-fade-in{ from{opacity:0} to{opacity:1} }

.lightbox-bg{ position:absolute; inset:0; }
.lightbox-content{
  position:relative; z-index:2;
  display:flex; flex-direction:column;
  height:100dvh; max-width:98vw; width:100%;
  padding:12px 0 35px;      /* небольшой верхний, снизу — под thumbs */
  align-items:center;
}

/* Stage (картинка) — занимает весь остаток */
.lightbox-stage{
  flex:1 1 auto;
  min-height:0;
  display:flex; align-items:center; justify-content:center;
  position:relative;
}
/* Прелоадер (Lottie) */
.lightbox-loading{
  position:absolute; inset:0;
  display:none; align-items:center; justify-content:center;
  pointer-events:none;
}
.lightbox-stage.is-loading .lightbox-loading{ display:flex; }
.lightbox-stage.is-loading .lightbox-img{ visibility:hidden; }

#lottie-loader{ width:64px; height:64px; }

.lightbox-img{
  max-width:76vw;
  max-height:100%;
  object-fit:contain;
  border-radius:18px;
  box-shadow:0 8px 56px #000a;
  background:#181c22;
  display:block;
}

.lightbox-caption{
  flex:0 0 auto;
  margin:10px auto 8px;
  color:#e7eaf0; font-size:1.12rem; text-align:center;
  max-width:82vw; opacity:.90;
  overflow-wrap:break-word;
}

/* Стрелки и закрыть */
.lightbox-close,
.lightbox-arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:transparent;
  border:0; padding:0; cursor:pointer;
}
.lightbox-close{ top:12px; right:12px; transform:none; }
.lightbox-arrow.left{ left:8px; }
.lightbox-arrow.right{ right:8px; }
.lightbox-arrow img, .lightbox-close img{ display:block; }

/* Thumbnails rail (в потоке, внизу) */
.lightbox-thumbs-wrap{
  flex:0 0 auto;
  width:100%;
  max-width:100vw;
  padding:0 12px;
  box-sizing:border-box;
  display:flex; justify-content:center;
  margin-top:6px;
}
.lightbox-thumbs{
  --lb-thumb-size:50px;
  --lb-thumb-min:30px;
  --lb-gap:25px;
  display:flex; gap:var(--lb-gap);
  flex-wrap:nowrap; align-items:center; justify-content:center;
}
.lightbox-thumb{
  width:var(--lb-thumb-size); height:var(--lb-thumb-size);
  min-width:var(--lb-thumb-min); min-height:var(--lb-thumb-min);
  object-fit:cover; border-radius:8px;
  opacity:.4; filter:saturate(.9);
  transition:opacity .18s, transform .18s;
  cursor:pointer; user-select:none; display:block;
}
.lightbox-thumb.is-active{
  opacity:1;
  outline:2px solid var(--brand);
  outline-offset:2px;
}
.lightbox-thumb:focus-visible{
  outline:2px solid var(--brand);
  outline-offset:2px;
}

/* =========================
   Accessibility
   ========================= */
:focus-visible{ outline:2px solid var(--brand); outline-offset:3px; }

/* =========================
   Cases: Stage summary (Playfair italic)
   ========================= */
.stage-summary{
  font-family:"Playfair", ui-serif, Georgia, serif;
  font-size:1.2rem;
  font-style:italic;
  color:#e2e5e7;
  opacity:.93;
  margin-top:24px;
}
@media (max-width:980px){ .stage-summary{ margin-top:12px; } }
