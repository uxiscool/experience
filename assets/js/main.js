// Project images data - will be generated by Jekyll
let projectImages = [];
let currentProject = 0;
let currentImage = 0;

// Initialize project images from page data
document.addEventListener('DOMContentLoaded', function() {
    // Collect all project images
    const projects = document.querySelectorAll('.project');
    projects.forEach((project, projectIndex) => {
        const images = project.querySelectorAll('.project-image img');
        projectImages[projectIndex] = [];
        images.forEach(img => {
            projectImages[projectIndex].push(img.src);
        });
    });
});

// Mobile menu
const mobileMenuToggle = document.getElementById('mobileMenuToggle');
const mobileMenu = document.getElementById('mobileMenu');

if (mobileMenuToggle && mobileMenu) {
    mobileMenuToggle.addEventListener('click', () => {
        mobileMenu.style.display = mobileMenu.style.display === 'flex' ? 'none' : 'flex';
        mobileMenuToggle.textContent = mobileMenu.style.display === 'flex' ? '×' : '☰';
    });

    // Close mobile menu when clicking on a link
    document.querySelectorAll('.mobile-menu-content a').forEach(link => {
        link.addEventListener('click', () => {
            mobileMenu.style.display = 'none';
            mobileMenuToggle.textContent = '☰';
        });
    });
}

// Lightbox functions
function openLightbox(projectIndex, imageIndex) {
    currentProject = projectIndex;
    currentImage = imageIndex;
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightboxImage');
    
    if (lightbox && lightboxImage && projectImages[projectIndex]) {
        lightboxImage.src = projectImages[projectIndex][imageIndex];
        lightbox.style.display = 'flex';
        
        // Smooth fade in
        setTimeout(() => {
            lightbox.style.opacity = '1';
        }, 10);
    }
}

function closeLightbox() {
    const lightbox = document.getElementById('lightbox');
    if (lightbox) {
        lightbox.style.display = 'none';
    }
}

function nextImage() {
    if (projectImages[currentProject]) {
        const totalImages = projectImages[currentProject].length;
        currentImage = (currentImage + 1) % totalImages;
        const lightboxImage = document.getElementById('lightboxImage');
        
        if (lightboxImage) {
            // Smooth transition
            lightboxImage.style.opacity = '0.5';
            setTimeout(() => {
                lightboxImage.src = projectImages[currentProject][currentImage];
                lightboxImage.style.opacity = '1';
            }, 150);
        }
    }
}

function prevImage() {
    if (projectImages[currentProject]) {
        const totalImages = projectImages[currentProject].length;
        currentImage = currentImage === 0 ? totalImages - 1 : currentImage - 1;
        const lightboxImage = document.getElementById('lightboxImage');
        
        if (lightboxImage) {
            // Smooth transition
            lightboxImage.style.opacity = '0.5';
            setTimeout(() => {
                lightboxImage.src = projectImages[currentProject][currentImage];
                lightboxImage.style.opacity = '1';
            }, 150);
        }
    }
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Close lightbox on click outside image
    const lightbox = document.getElementById('lightbox');
    if (lightbox) {
        lightbox.addEventListener('click', (e) => {
            if (e.target.id === 'lightbox') {
                closeLightbox();
            }
        });
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
        const lightbox = document.getElementById('lightbox');
        if (lightbox && lightbox.style.display === 'flex') {
            switch(e.key) {
                case 'Escape':
                    closeLightbox();
                    break;
                case 'ArrowLeft':
                    prevImage();
                    break;
                case 'ArrowRight':
                    nextImage();
                    break;
            }
        }
    });
});