<header>
  <div class="logo"><a href="/">Vladimir Zhukov</a></div>
  <nav class="main-menu">
    {% assign nav = site.data.navigation.main %}
    {% assign pageurl = page.url %}
    {% for item in nav %}
      {% assign is_current = false %}
      {% if item.url == pageurl %}
        {% assign is_current = true %}
      {% else %}
        {% if item.subnav %}
          {% for sub in item.subnav %}
            {% if sub.url == pageurl %}
              {% assign is_current = true %}
            {% endif %}
          {% endfor %}
        {% endif %}
      {% endif %}
      <a href="{{ item.url }}" class="menu-link{% if is_current %} current{% endif %}">{{ item.title }}</a>
    {% endfor %}
  </nav>
  {% comment %} Второй уровень меню, только если есть у текущего пункта subnav {% endcomment %}
  {% assign current_main = nav | where: "url", pageurl | first %}
  {% unless current_main %}
    {% for item in nav %}
      {% if item.subnav %}
        {% for sub in item.subnav %}
          {% if sub.url == pageurl %}
            {% assign current_main = item %}
          {% endif %}
        {% endfor %}
      {% endif %}
    {% endfor %}
  {% endunless %}
  {% if current_main and current_main.subnav %}
    <nav class="subnav">
      {% for sub in current_main.subnav %}
        <a href="{{ sub.url }}" class="sub-link{% if sub.url == pageurl %} current{% endif %}">{{ sub.title }}</a>
      {% endfor %}
    </nav>
  {% endif %}
</header>
